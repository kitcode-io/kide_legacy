<!DOCTYPE html>
<html ng-app="plunker">

<head>
    <meta charset="utf-8" />
    <base href="/edit">
    <title ng-bind="title">cuboid.io - Editor</title>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.css"
    />
    <!-- inject:css -->
    <link rel="stylesheet" href="/editor/editor-d53ccff9.css">
    <!-- endinject -->
    <link rel="stylesheet" href="vendor/codemirror/lib/codemirror.css">
    <link rel="stylesheet" href="vendor/codemirror/theme/zenburn.css">
    <style>
        .hide {
            right: 0;
            width: 88%;
            position: fixed;
            height: 100%;
            top: 48px;
        }

        .show {
            z-index: 99999999999;
        }
    </style>
</head>

<body ng-controller="EditorController" plunker-overlay="editor">
    <div class="hide show" id="console"></div>
    <div fa-pane="container" keybindings>
        <div class="sidebar" fa-pane="sidebar" pane-anchor="west" pane-size="12%">
            <plunker-sidebar></plunker-sidebar>
        </div>
        <div fa-pane="workspace" pane-anchor="west" pane-size="100%">
            <plunker-workspace></plunker-workspace>
            <plunker-toolbar></plunker-toolbar>
        </div>
    </div>
    <div growl></div>
    <script src="vendor/codemirror/lib/codemirror.js"></script>
    <script src="vendor/codemirror/mode/javascript/javascript.js"></script>
    <script src="vendor/angular/angular.js"></script>
    <script src="vendor/ui-bootstrap/ui-bootstrap.js"></script>
    <script src="vendor/socket.io-client/dist/socket.io.js"></script>
    <!-- inject:js -->
    <script src="/editor/editor-1441a790.js"></script>
    <!-- endinject -->
    <script>
        angular.module("plunker.service.config", []).value("config",
        {
            "url":
            {
                "api": "http://localhost:8080",
                "run": {{{json url}}}.run,
                "web": "http://localhost:8080"
            }
        });

        function show()
        {
            document.getElementById("console").classList.add("show");
        }

        function hide()
        {
            document.getElementById("console").classList.remove("show");
        }
    </script>

    <script>
        function bindEvent(element, eventName, eventHandler)
        {
            if (element.addEventListener)
            {
                element.addEventListener(eventName, eventHandler, false);
            }
            else if (element.attachEvent)
            {
                element.attachEvent('on' + eventName, eventHandler);
            }
        }

        window.onload = function()
        {
            window.parent.postMessage('loaded', '*');
        };

        bindEvent(window, 'message', function(e)
        {
            var data = JSON.parse(e.data);
            document.getElementById("console").innerHTML =
                "<iframe src=\"" + data.terminal +
                "\" style=\"width: 100%;height:100%; \" frameborder=\"0\"></iframe>";
            document.getElementById("eye").innerHTML =
                "<a style=\"background-color: #555; color: white;\" target=\"_blank\" href=\"" +
                data.preview +
                "\"><i class=\"fa fa-eye\" aria-hidden=\"true\"></i></a>"
        });
    </script>

</body>

</html>
